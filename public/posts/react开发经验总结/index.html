<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>React开发经验总结 | 闫庆国的个人网站</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="深入探讨React开发中的性能优化、组件设计、状态管理等核心技术，结合实战经验分享最佳实践">
<meta name="generator" content="Hugo 0.147.7">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>首页</a>
	
	<a href="/posts">归档</a>
	<a href="/tags">标签</a>
	<a href="/about">关于</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">React开发经验总结</h1>

    <div class="tip">
        <time datetime="2025-06-05 00:00:00 &#43;0000 UTC">2025年06月05日</time>
        <span class="split">
          ·
        </span>
        <span>
          2573字
        </span>
        <span class="split">
          ·
        </span>
        <span>
          6分钟
        </span>
    </div>


    <div class="content">
      <div>
        <p>写出更好的 React 代码 🚀</p>
<h2 id="深入理解组件渲染优化">深入理解组件渲染优化 <a href="#%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%e7%bb%84%e4%bb%b6%e6%b8%b2%e6%9f%93%e4%bc%98%e5%8c%96" class="anchor">🔗</a></h2><h3 id="何时使用-reactmemo">何时使用 React.memo <a href="#%e4%bd%95%e6%97%b6%e4%bd%bf%e7%94%a8-reactmemo" class="anchor">🔗</a></h3><p>在 React 应用中，性能优化的第一步是避免不必要的渲染。<code>React.memo</code> 是一个强大的工具，但它的使用需要遵循一些原则：</p>
<p>使用 memo 时需要注意：</p>
<ol>
<li><strong>引用类型属性处理</strong>：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 父组件
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> Parent <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 使用 useCallback 缓存函数
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  <span style="color:#a2f;font-weight:bold">const</span> handleClick <span style="color:#666">=</span> useCallback(() =&gt; {
</span></span><span style="display:flex;"><span>    console.log(<span style="color:#b44">&#34;clicked&#34;</span>);
</span></span><span style="display:flex;"><span>  }, []);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 使用 useMemo 缓存对象
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  <span style="color:#a2f;font-weight:bold">const</span> config <span style="color:#666">=</span> useMemo(
</span></span><span style="display:flex;"><span>    () =&gt; ({
</span></span><span style="display:flex;"><span>      color<span style="color:#666">:</span> <span style="color:#b44">&#34;blue&#34;</span>,
</span></span><span style="display:flex;"><span>      fontSize<span style="color:#666">:</span> <span style="color:#666">14</span>,
</span></span><span style="display:flex;"><span>    }),
</span></span><span style="display:flex;"><span>    []
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">Child</span> <span style="color:#b44">onClick</span><span style="color:#666">=</span>{handleClick} <span style="color:#b44">config</span><span style="color:#666">=</span>{config} /&gt;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol start="2">
<li><strong>避免过度优化</strong>：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 过度优化的例子
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> SimpleText <span style="color:#666">=</span> React.memo((props) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">span</span>&gt;{props.text}&lt;/<span style="color:#008000;font-weight:bold">span</span>&gt;;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 不需要 memo 的简单组件
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> SimpleText <span style="color:#666">=</span> (props) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">span</span>&gt;{props.text}&lt;/<span style="color:#008000;font-weight:bold">span</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="组件设计的艺术">组件设计的艺术 <a href="#%e7%bb%84%e4%bb%b6%e8%ae%be%e8%ae%a1%e7%9a%84%e8%89%ba%e6%9c%af" class="anchor">🔗</a></h2><h3 id="组件分层架构">组件分层架构 <a href="#%e7%bb%84%e4%bb%b6%e5%88%86%e5%b1%82%e6%9e%b6%e6%9e%84" class="anchor">🔗</a></h3><p>在大型应用中，推荐采用以下分层架构：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 1. 展示组件 (Presentational Components)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> UserCard <span style="color:#666">=</span> ({ name, avatar, role }) =&gt; (
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#008000;font-weight:bold">div</span> <span style="color:#b44">className</span><span style="color:#666">=</span><span style="color:#b44">&#34;user-card&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">img</span> <span style="color:#b44">src</span><span style="color:#666">=</span>{avatar} <span style="color:#b44">alt</span><span style="color:#666">=</span>{name} /&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">h3</span>&gt;{name}&lt;/<span style="color:#008000;font-weight:bold">h3</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">span</span>&gt;{role}&lt;/<span style="color:#008000;font-weight:bold">span</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 2. 容器组件 (Container Components)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> UserListContainer <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [users, setUsers] <span style="color:#666">=</span> useState([]);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [loading, setLoading] <span style="color:#666">=</span> useState(<span style="color:#a2f;font-weight:bold">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    fetchUsers().then((data) =&gt; setUsers(data));
</span></span><span style="display:flex;"><span>  }, []);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> loading <span style="color:#666">?</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">Loading</span> /&gt;
</span></span><span style="display:flex;"><span>  ) <span style="color:#666">:</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">div</span> <span style="color:#b44">className</span><span style="color:#666">=</span><span style="color:#b44">&#34;user-list&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      {users.map((user) =&gt; (
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#008000;font-weight:bold">UserCard</span> <span style="color:#b44">key</span><span style="color:#666">=</span>{user.id} {<span style="color:#b44">...user</span>} /&gt;
</span></span><span style="display:flex;"><span>      ))}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 3. 页面组件 (Page Components)
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> UserManagementPage <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">Layout</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#008000;font-weight:bold">Header</span> <span style="color:#b44">title</span><span style="color:#666">=</span><span style="color:#b44">&#34;用户管理&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#008000;font-weight:bold">UserListContainer</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#008000;font-weight:bold">Footer</span> /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#008000;font-weight:bold">Layout</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="组件通信最佳实践">组件通信最佳实践 <a href="#%e7%bb%84%e4%bb%b6%e9%80%9a%e4%bf%a1%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5" class="anchor">🔗</a></h3><ol>
<li><strong>Props 透传问题</strong>：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 不推荐：props 层层传递
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> Grandfather <span style="color:#666">=</span> ({ userData }) =&gt; &lt;<span style="color:#008000;font-weight:bold">Father</span> <span style="color:#b44">userData</span><span style="color:#666">=</span>{userData} /&gt;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> Father <span style="color:#666">=</span> ({ userData }) =&gt; &lt;<span style="color:#008000;font-weight:bold">Son</span> <span style="color:#b44">userData</span><span style="color:#666">=</span>{userData} /&gt;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 推荐：使用 Context
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> UserContext <span style="color:#666">=</span> React.createContext(<span style="color:#a2f;font-weight:bold">null</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> Grandfather <span style="color:#666">=</span> ({ userData }) =&gt; (
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#008000;font-weight:bold">UserContext.Provider</span> <span style="color:#b44">value</span><span style="color:#666">=</span>{userData}&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">Father</span> /&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#008000;font-weight:bold">UserContext.Provider</span>&gt;
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> Son <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> userData <span style="color:#666">=</span> useContext(UserContext);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;{userData.name}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="状态管理的最佳实践">状态管理的最佳实践 <a href="#%e7%8a%b6%e6%80%81%e7%ae%a1%e7%90%86%e7%9a%84%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5" class="anchor">🔗</a></h2><h3 id="本地状态管理">本地状态管理 <a href="#%e6%9c%ac%e5%9c%b0%e7%8a%b6%e6%80%81%e7%ae%a1%e7%90%86" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 使用 useState 的最佳实践
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> TodoList <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 1. 状态聚合
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  <span style="color:#a2f;font-weight:bold">const</span> [todoState, setTodoState] <span style="color:#666">=</span> useState({
</span></span><span style="display:flex;"><span>    items<span style="color:#666">:</span> [],
</span></span><span style="display:flex;"><span>    loading<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>    error<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">null</span>
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 2. 状态更新函数
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  <span style="color:#a2f;font-weight:bold">const</span> addTodo <span style="color:#666">=</span> useCallback((newTodo) =&gt; {
</span></span><span style="display:flex;"><span>    setTodoState(prev =&gt; ({
</span></span><span style="display:flex;"><span>      ...prev,
</span></span><span style="display:flex;"><span>      items<span style="color:#666">:</span> [...prev.items, newTodo]
</span></span><span style="display:flex;"><span>    }));
</span></span><span style="display:flex;"><span>  }, []);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 3. 派生状态
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  <span style="color:#a2f;font-weight:bold">const</span> completedCount <span style="color:#666">=</span> useMemo(() =&gt;
</span></span><span style="display:flex;"><span>    todoState.items.filter(item =&gt; item.completed).length,
</span></span><span style="display:flex;"><span>    [todoState.items]
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (<span style="color:#080;font-style:italic">/* 渲染逻辑 */</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="全局状态管理">全局状态管理 <a href="#%e5%85%a8%e5%b1%80%e7%8a%b6%e6%80%81%e7%ae%a1%e7%90%86" class="anchor">🔗</a></h3><p>在选择状态管理方案时，建议：</p>
<ol>
<li><strong>小型应用</strong>：Context + useReducer</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 定义 action 类型
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> TodoActions <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span>  ADD_TODO<span style="color:#666">:</span> <span style="color:#b44">&#34;ADD_TODO&#34;</span>,
</span></span><span style="display:flex;"><span>  TOGGLE_TODO<span style="color:#666">:</span> <span style="color:#b44">&#34;TOGGLE_TODO&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 创建 reducer
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> todoReducer <span style="color:#666">=</span> (state, action) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">switch</span> (action.type) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">case</span> TodoActions.ADD_TODO<span style="color:#666">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>        ...state,
</span></span><span style="display:flex;"><span>        todos<span style="color:#666">:</span> [...state.todos, action.payload],
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-style:italic">// ...其他 case
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  }
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 使用 Provider
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> TodoProvider <span style="color:#666">=</span> ({ children }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [state, dispatch] <span style="color:#666">=</span> useReducer(todoReducer, initialState);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">TodoContext.Provider</span> <span style="color:#b44">value</span><span style="color:#666">=</span>{{ state, dispatch }}&gt;
</span></span><span style="display:flex;"><span>      {children}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#008000;font-weight:bold">TodoContext.Provider</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol start="2">
<li><strong>中大型应用</strong>：Redux/Zustand</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// Zustand 示例
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">import</span> create from <span style="color:#b44">&#34;zustand&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> useStore <span style="color:#666">=</span> create((set) =&gt; ({
</span></span><span style="display:flex;"><span>  todos<span style="color:#666">:</span> [],
</span></span><span style="display:flex;"><span>  addTodo<span style="color:#666">:</span> (todo) =&gt;
</span></span><span style="display:flex;"><span>    set((state) =&gt; ({
</span></span><span style="display:flex;"><span>      todos<span style="color:#666">:</span> [...state.todos, todo],
</span></span><span style="display:flex;"><span>    })),
</span></span><span style="display:flex;"><span>  toggleTodo<span style="color:#666">:</span> (id) =&gt;
</span></span><span style="display:flex;"><span>    set((state) =&gt; ({
</span></span><span style="display:flex;"><span>      todos<span style="color:#666">:</span> state.todos.map((todo) =&gt;
</span></span><span style="display:flex;"><span>        todo.id <span style="color:#666">===</span> id <span style="color:#666">?</span> { ...todo, completed<span style="color:#666">:</span> <span style="color:#666">!</span>todo.completed } <span style="color:#666">:</span> todo
</span></span><span style="display:flex;"><span>      ),
</span></span><span style="display:flex;"><span>    })),
</span></span><span style="display:flex;"><span>}));
</span></span></code></pre></div><h2 id="react-18-新特性应用">React 18 新特性应用 <a href="#react-18-%e6%96%b0%e7%89%b9%e6%80%a7%e5%ba%94%e7%94%a8" class="anchor">🔗</a></h2><h3 id="并发渲染实践">并发渲染实践 <a href="#%e5%b9%b6%e5%8f%91%e6%b8%b2%e6%9f%93%e5%ae%9e%e8%b7%b5" class="anchor">🔗</a></h3><ol>
<li><strong>useTransition 优化用户体验</strong>：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> SearchComponent <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [query, setQuery] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [isPending, startTransition] <span style="color:#666">=</span> useTransition();
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [searchResults, setSearchResults] <span style="color:#666">=</span> useState([]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> handleSearch <span style="color:#666">=</span> (e) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-style:italic">// 立即更新输入值
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    setQuery(e.target.value);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-style:italic">// 将搜索逻辑放在 transition 中
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    startTransition(() =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">const</span> results <span style="color:#666">=</span> performExpensiveSearch(e.target.value);
</span></span><span style="display:flex;"><span>      setSearchResults(results);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#008000;font-weight:bold">input</span> <span style="color:#b44">value</span><span style="color:#666">=</span>{query} <span style="color:#b44">onChange</span><span style="color:#666">=</span>{handleSearch} /&gt;
</span></span><span style="display:flex;"><span>      {isPending <span style="color:#666">?</span> &lt;<span style="color:#008000;font-weight:bold">Spinner</span> /&gt; <span style="color:#666">:</span> &lt;<span style="color:#008000;font-weight:bold">SearchResults</span> <span style="color:#b44">results</span><span style="color:#666">=</span>{searchResults} /&gt;}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol start="2">
<li><strong>useDeferredValue 处理昂贵的渲染</strong>：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> Chart <span style="color:#666">=</span> memo(({ data }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 复杂的图表渲染逻辑
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> ChartContainer <span style="color:#666">=</span> ({ data }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> deferredData <span style="color:#666">=</span> useDeferredValue(data);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>    &lt;&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#008000;font-weight:bold">Chart</span> <span style="color:#b44">data</span><span style="color:#666">=</span>{deferredData} /&gt;
</span></span><span style="display:flex;"><span>      {deferredData <span style="color:#666">!==</span> data <span style="color:#666">&amp;&amp;</span> &lt;<span style="color:#008000;font-weight:bold">Spinner</span> /&gt;}
</span></span><span style="display:flex;"><span>    &lt;/&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="列表渲染优化">列表渲染优化 <a href="#%e5%88%97%e8%a1%a8%e6%b8%b2%e6%9f%93%e4%bc%98%e5%8c%96" class="anchor">🔗</a></h2><h3 id="虚拟列表实现">虚拟列表实现 <a href="#%e8%99%9a%e6%8b%9f%e5%88%97%e8%a1%a8%e5%ae%9e%e7%8e%b0" class="anchor">🔗</a></h3><p>对于长列表，建议使用虚拟滚动：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">import</span> { FixedSizeList } from <span style="color:#b44">&#34;react-window&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> VirtualizedList <span style="color:#666">=</span> ({ items }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> Row <span style="color:#666">=</span> ({ index, style }) =&gt; (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">div</span> <span style="color:#b44">style</span><span style="color:#666">=</span>{style}&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#008000;font-weight:bold">ListItem</span> <span style="color:#b44">data</span><span style="color:#666">=</span>{items[index]} /&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#008000;font-weight:bold">FixedSizeList</span>
</span></span><span style="display:flex;"><span>      <span style="color:#b44">height</span><span style="color:#666">=</span>{<span style="color:#666">400</span>}
</span></span><span style="display:flex;"><span>      <span style="color:#b44">width</span><span style="color:#666">=</span><span style="color:#b44">&#34;100%&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#b44">itemCount</span><span style="color:#666">=</span>{items.length}
</span></span><span style="display:flex;"><span>      <span style="color:#b44">itemSize</span><span style="color:#666">=</span>{<span style="color:#666">50</span>}
</span></span><span style="display:flex;"><span>    &gt;
</span></span><span style="display:flex;"><span>      {Row}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#008000;font-weight:bold">FixedSizeList</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="key-的最佳实践">Key 的最佳实践 <a href="#key-%e7%9a%84%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 避免使用索引作为 key
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>{
</span></span><span style="display:flex;"><span>  items.map((item, index) =&gt; &lt;<span style="color:#008000;font-weight:bold">ListItem</span> <span style="color:#b44">key</span><span style="color:#666">=</span>{index} <span style="color:#b44">data</span><span style="color:#666">=</span>{item} /&gt;);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 使用唯一标识作为 key
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>{
</span></span><span style="display:flex;"><span>  items.map((item) =&gt; &lt;<span style="color:#008000;font-weight:bold">ListItem</span> <span style="color:#b44">key</span><span style="color:#666">=</span>{item.id} <span style="color:#b44">data</span><span style="color:#666">=</span>{item} /&gt;);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 如果没有唯一 ID，可以这样生成
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> generateKey <span style="color:#666">=</span> (item, index) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#b44">`</span><span style="color:#b68;font-weight:bold">${</span>item.type<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">_</span><span style="color:#b68;font-weight:bold">${</span>item.name<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">_</span><span style="color:#b68;font-weight:bold">${</span>index<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="数据持久化方案">数据持久化方案 <a href="#%e6%95%b0%e6%8d%ae%e6%8c%81%e4%b9%85%e5%8c%96%e6%96%b9%e6%a1%88" class="anchor">🔗</a></h2><h3 id="本地存储实现">本地存储实现 <a href="#%e6%9c%ac%e5%9c%b0%e5%ad%98%e5%82%a8%e5%ae%9e%e7%8e%b0" class="anchor">🔗</a></h3><p>使用 redux-persist 实现本地数据持久化：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">import</span> { createStore } from <span style="color:#b44">&#34;redux&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">import</span> { persistStore, persistReducer } from <span style="color:#b44">&#34;redux-persist&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">import</span> storage from <span style="color:#b44">&#34;redux-persist/lib/storage&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> persistConfig <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span>  key<span style="color:#666">:</span> <span style="color:#b44">&#34;root&#34;</span>,
</span></span><span style="display:flex;"><span>  storage<span style="color:#666">:</span> storage,
</span></span><span style="display:flex;"><span>  whitelist<span style="color:#666">:</span> [<span style="color:#b44">&#34;user&#34;</span>, <span style="color:#b44">&#34;settings&#34;</span>], <span style="color:#080;font-style:italic">// 只持久化特定 reducer
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> persistedReducer <span style="color:#666">=</span> persistReducer(persistConfig, rootReducer);
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> store <span style="color:#666">=</span> createStore(persistedReducer);
</span></span><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> persistor <span style="color:#666">=</span> persistStore(store);
</span></span></code></pre></div><h3 id="服务器存储实现">服务器存储实现 <a href="#%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%ad%98%e5%82%a8%e5%ae%9e%e7%8e%b0" class="anchor">🔗</a></h3><p>自定义 storage 引擎实现服务端持久化：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> customStorage <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">async</span> getItem(key) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">const</span> response <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">await</span> fetch(<span style="color:#b44">`/api/state/</span><span style="color:#b68;font-weight:bold">${</span>key<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>, {
</span></span><span style="display:flex;"><span>        headers<span style="color:#666">:</span> {
</span></span><span style="display:flex;"><span>          Authorization<span style="color:#666">:</span> <span style="color:#b44">`Bearer </span><span style="color:#b68;font-weight:bold">${</span>getToken()<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#b44">&#34;Content-Type&#34;</span><span style="color:#666">:</span> <span style="color:#b44">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">if</span> (<span style="color:#666">!</span>response.ok) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">throw</span> <span style="color:#a2f;font-weight:bold">new</span> <span style="color:#a2f">Error</span>(<span style="color:#b44">&#34;获取状态失败&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">const</span> data <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">await</span> response.json();
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">return</span> JSON.stringify(data.state);
</span></span><span style="display:flex;"><span>    } <span style="color:#a2f;font-weight:bold">catch</span> (err) {
</span></span><span style="display:flex;"><span>      console.error(<span style="color:#b44">&#34;从服务器获取状态失败:&#34;</span>, err);
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">return</span> <span style="color:#a2f;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">async</span> setItem(key, value) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">const</span> response <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">await</span> fetch(<span style="color:#b44">`/api/state/</span><span style="color:#b68;font-weight:bold">${</span>key<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>, {
</span></span><span style="display:flex;"><span>        method<span style="color:#666">:</span> <span style="color:#b44">&#34;POST&#34;</span>,
</span></span><span style="display:flex;"><span>        headers<span style="color:#666">:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#b44">&#34;Content-Type&#34;</span><span style="color:#666">:</span> <span style="color:#b44">&#34;application/json&#34;</span>,
</span></span><span style="display:flex;"><span>          Authorization<span style="color:#666">:</span> <span style="color:#b44">`Bearer </span><span style="color:#b68;font-weight:bold">${</span>getToken()<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        body<span style="color:#666">:</span> JSON.stringify({
</span></span><span style="display:flex;"><span>          state<span style="color:#666">:</span> JSON.parse(value),
</span></span><span style="display:flex;"><span>          timestamp<span style="color:#666">:</span> <span style="color:#a2f">Date</span>.now(),
</span></span><span style="display:flex;"><span>        }),
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">if</span> (<span style="color:#666">!</span>response.ok) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">throw</span> <span style="color:#a2f;font-weight:bold">new</span> <span style="color:#a2f">Error</span>(<span style="color:#b44">&#34;保存状态失败&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#a2f;font-weight:bold">catch</span> (err) {
</span></span><span style="display:flex;"><span>      console.error(<span style="color:#b44">&#34;保存状态到服务器失败:&#34;</span>, err);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">async</span> removeItem(key) {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">const</span> response <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">await</span> fetch(<span style="color:#b44">`/api/state/</span><span style="color:#b68;font-weight:bold">${</span>key<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>, {
</span></span><span style="display:flex;"><span>        method<span style="color:#666">:</span> <span style="color:#b44">&#34;DELETE&#34;</span>,
</span></span><span style="display:flex;"><span>        headers<span style="color:#666">:</span> {
</span></span><span style="display:flex;"><span>          Authorization<span style="color:#666">:</span> <span style="color:#b44">`Bearer </span><span style="color:#b68;font-weight:bold">${</span>getToken()<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">if</span> (<span style="color:#666">!</span>response.ok) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">throw</span> <span style="color:#a2f;font-weight:bold">new</span> <span style="color:#a2f">Error</span>(<span style="color:#b44">&#34;删除状态失败&#34;</span>);
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#a2f;font-weight:bold">catch</span> (err) {
</span></span><span style="display:flex;"><span>      console.error(<span style="color:#b44">&#34;从服务器删除状态失败:&#34;</span>, err);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 配置 redux-persist 使用自定义 storage
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> persistConfig <span style="color:#666">=</span> {
</span></span><span style="display:flex;"><span>  key<span style="color:#666">:</span> <span style="color:#b44">&#34;root&#34;</span>,
</span></span><span style="display:flex;"><span>  storage<span style="color:#666">:</span> customStorage,
</span></span><span style="display:flex;"><span>  timeout<span style="color:#666">:</span> <span style="color:#666">10000</span>, <span style="color:#080;font-style:italic">// 设置超时时间
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  whitelist<span style="color:#666">:</span> [<span style="color:#b44">&#34;user&#34;</span>, <span style="color:#b44">&#34;settings&#34;</span>],
</span></span><span style="display:flex;"><span>  writeFailHandler<span style="color:#666">:</span> (err) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-style:italic">// 处理写入失败的情况
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    console.error(<span style="color:#b44">&#34;State 持久化失败:&#34;</span>, err);
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="你可能不需要使用-useeffect">你可能不需要使用 useEffect <a href="#%e4%bd%a0%e5%8f%af%e8%83%bd%e4%b8%8d%e9%9c%80%e8%a6%81%e4%bd%bf%e7%94%a8-useeffect" class="anchor">🔗</a></h2><p>在 React 开发中，useEffect 是最容易被过度使用的 Hook 之一。很多开发者倾向于把所有的副作用都放在 useEffect 中，这可能会导致一些不必要的问题。让我们来看看什么时候可以避免使用 useEffect。</p>
<h3 id="1-事件处理中的副作用">1. 事件处理中的副作用 <a href="#1-%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86%e4%b8%ad%e7%9a%84%e5%89%af%e4%bd%9c%e7%94%a8" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 不必要的 useEffect
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> SearchComponent <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [query, setQuery] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span> (query) {
</span></span><span style="display:flex;"><span>      performSearch(query);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }, [query]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">input</span> <span style="color:#b44">value</span><span style="color:#666">=</span>{query} <span style="color:#b44">onChange</span><span style="color:#666">=</span>{(e) =&gt; setQuery(e.target.value)} /&gt;;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 更好的方式：直接在事件处理函数中执行
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> SearchComponent <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [query, setQuery] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> handleChange <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">async</span> (e) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">const</span> newQuery <span style="color:#666">=</span> e.target.value;
</span></span><span style="display:flex;"><span>    setQuery(newQuery);
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">if</span> (newQuery) {
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">await</span> performSearch(newQuery);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">input</span> <span style="color:#b44">value</span><span style="color:#666">=</span>{query} <span style="color:#b44">onChange</span><span style="color:#666">=</span>{handleChange} /&gt;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="2-props-改变后的计算">2. props 改变后的计算 <a href="#2-props-%e6%94%b9%e5%8f%98%e5%90%8e%e7%9a%84%e8%ae%a1%e7%ae%97" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 不必要的 useEffect
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> ProductCard <span style="color:#666">=</span> ({ price, quantity }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [total, setTotal] <span style="color:#666">=</span> useState(<span style="color:#666">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    setTotal(price <span style="color:#666">*</span> quantity);
</span></span><span style="display:flex;"><span>  }, [price, quantity]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;总价<span style="">：</span>{total}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 使用计算属性
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> ProductCard <span style="color:#666">=</span> ({ price, quantity }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> total <span style="color:#666">=</span> price <span style="color:#666">*</span> quantity;
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;总价<span style="">：</span>{total}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 如果计算比较复杂，可以使用 useMemo
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> ProductCard <span style="color:#666">=</span> ({ price, quantity, discount }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> total <span style="color:#666">=</span> useMemo(() =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> calculateComplexTotal(price, quantity, discount);
</span></span><span style="display:flex;"><span>  }, [price, quantity, discount]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;总价<span style="">：</span>{total}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="3-状态联动更新">3. 状态联动更新 <a href="#3-%e7%8a%b6%e6%80%81%e8%81%94%e5%8a%a8%e6%9b%b4%e6%96%b0" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 避免使用 useEffect 进行状态联动
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> Form <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [firstName, setFirstName] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [lastName, setLastName] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [fullName, setFullName] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    setFullName(<span style="color:#b44">`</span><span style="color:#b68;font-weight:bold">${</span>firstName<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44"> </span><span style="color:#b68;font-weight:bold">${</span>lastName<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>);
</span></span><span style="display:flex;"><span>  }, [firstName, lastName]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (<span style="color:#080;font-style:italic">/* 渲染逻辑 */</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 直接在事件处理函数中更新关联状态
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> Form <span style="color:#666">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [firstName, setFirstName] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [lastName, setLastName] <span style="color:#666">=</span> useState(<span style="color:#b44">&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> handleFirstNameChange <span style="color:#666">=</span> (e) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">const</span> newFirstName <span style="color:#666">=</span> e.target.value;
</span></span><span style="display:flex;"><span>    setFirstName(newFirstName);
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#080;font-style:italic">// 或者使用派生状态
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>  <span style="color:#a2f;font-weight:bold">const</span> fullName <span style="color:#666">=</span> <span style="color:#b44">`</span><span style="color:#b68;font-weight:bold">${</span>firstName<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44"> </span><span style="color:#b68;font-weight:bold">${</span>lastName<span style="color:#b68;font-weight:bold">}</span><span style="color:#b44">`</span>.trim();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (<span style="color:#080;font-style:italic">/* 渲染逻辑 */</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="4-数据请求">4. 数据请求 <a href="#4-%e6%95%b0%e6%8d%ae%e8%af%b7%e6%b1%82" class="anchor">🔗</a></h3><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 🔴 不推荐：在 useEffect 中直接请求数据
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> UserProfile <span style="color:#666">=</span> ({ userId }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [user, setUser] <span style="color:#666">=</span> useState(<span style="color:#a2f;font-weight:bold">null</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [error, setError] <span style="color:#666">=</span> useState(<span style="color:#a2f;font-weight:bold">null</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    fetchUser(userId)
</span></span><span style="display:flex;"><span>      .then((data) =&gt; setUser(data))
</span></span><span style="display:flex;"><span>      .<span style="color:#a2f;font-weight:bold">catch</span>((err) =&gt; setError(err));
</span></span><span style="display:flex;"><span>  }, [userId]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">if</span> (error) <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;<span style="color:#a2f">Error</span><span style="color:#666">:</span> {error.message}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">if</span> (<span style="color:#666">!</span>user) <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;Loading...&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;{user.name}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// ✅ 推荐：使用自定义 Hook 封装数据请求逻辑
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> useUser <span style="color:#666">=</span> (userId) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [state, setState] <span style="color:#666">=</span> useState({
</span></span><span style="display:flex;"><span>    data<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">null</span>,
</span></span><span style="display:flex;"><span>    error<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">null</span>,
</span></span><span style="display:flex;"><span>    loading<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">true</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">let</span> mounted <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">const</span> loadUser <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a2f;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        setState((prev) =&gt; ({ ...prev, loading<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">true</span> }));
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">const</span> data <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">await</span> fetchUser(userId);
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span> (mounted) {
</span></span><span style="display:flex;"><span>          setState({ data, loading<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">false</span>, error<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">null</span> });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      } <span style="color:#a2f;font-weight:bold">catch</span> (error) {
</span></span><span style="display:flex;"><span>        <span style="color:#a2f;font-weight:bold">if</span> (mounted) {
</span></span><span style="display:flex;"><span>          setState({ data<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">null</span>, loading<span style="color:#666">:</span> <span style="color:#a2f;font-weight:bold">false</span>, error });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    loadUser();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">return</span> () =&gt; {
</span></span><span style="display:flex;"><span>      mounted <span style="color:#666">=</span> <span style="color:#a2f;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }, [userId]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> state;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">// 使用自定义 Hook
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span><span style="color:#a2f;font-weight:bold">const</span> UserProfile <span style="color:#666">=</span> ({ userId }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> { data<span style="color:#666">:</span> user, error, loading } <span style="color:#666">=</span> useUser(userId);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">if</span> (loading) <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;Loading...&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">if</span> (error) <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;<span style="color:#a2f">Error</span><span style="color:#666">:</span> {error.message}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> &lt;<span style="color:#008000;font-weight:bold">div</span>&gt;{user.name}&lt;/<span style="color:#008000;font-weight:bold">div</span>&gt;;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="5-订阅与取消订阅">5. 订阅与取消订阅 <a href="#5-%e8%ae%a2%e9%98%85%e4%b8%8e%e5%8f%96%e6%b6%88%e8%ae%a2%e9%98%85" class="anchor">🔗</a></h3><p>这种场景确实需要使用 useEffect，但要注意清理函数：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">const</span> ChatRoom <span style="color:#666">=</span> ({ roomId }) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">const</span> [messages, setMessages] <span style="color:#666">=</span> useState([]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  useEffect(() =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">const</span> connection <span style="color:#666">=</span> createConnection(roomId);
</span></span><span style="display:flex;"><span>    connection.connect();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a2f;font-weight:bold">const</span> handleMessage <span style="color:#666">=</span> (message) =&gt; {
</span></span><span style="display:flex;"><span>      setMessages(prev =&gt; [...prev, message]);
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    connection.on(<span style="color:#b44">&#39;message&#39;</span>, handleMessage);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#080;font-style:italic">// 清理函数：断开连接并移除事件监听
</span></span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"></span>    <span style="color:#a2f;font-weight:bold">return</span> () =&gt; {
</span></span><span style="display:flex;"><span>      connection.off(<span style="color:#b44">&#39;message&#39;</span>, handleMessage);
</span></span><span style="display:flex;"><span>      connection.disconnect();
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }, [roomId]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a2f;font-weight:bold">return</span> (<span style="color:#080;font-style:italic">/* 渲染逻辑 */</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="最佳实践总结">最佳实践总结 <a href="#%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93" class="anchor">🔗</a></h3><ol>
<li>
<p><strong>优先考虑事件处理函数</strong>：如果副作用是由用户交互触发的，把它放在事件处理函数中。</p>
</li>
<li>
<p><strong>使用派生状态</strong>：如果某个状态可以由其他状态计算得出，直接计算而不是使用 effect。</p>
</li>
<li>
<p><strong>合理使用 useMemo</strong>：对于计算量大的派生状态，使用 useMemo 缓存结果。</p>
</li>
<li>
<p><strong>抽象复杂逻辑</strong>：将复杂的数据获取、订阅等逻辑封装成自定义 Hook。</p>
</li>
<li>
<p><strong>注意清理工作</strong>：当使用 useEffect 时，记得处理清理工作，避免内存泄漏。</p>
</li>
<li>
<p><strong>控制依赖项</strong>：仔细管理 useEffect 的依赖数组，避免遗漏或包含不必要的依赖。</p>
</li>
</ol>
<blockquote>
<p>本文持续更新中&hellip;</p></blockquote>
      </div>
      <div class="my-toc">
        
        
  
    <aside class="toc">
      <details open>
          <summary>
             目录
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#深入理解组件渲染优化">深入理解组件渲染优化</a>
      <ul>
        <li><a href="#何时使用-reactmemo">何时使用 React.memo</a></li>
      </ul>
    </li>
    <li><a href="#组件设计的艺术">组件设计的艺术</a>
      <ul>
        <li><a href="#组件分层架构">组件分层架构</a></li>
        <li><a href="#组件通信最佳实践">组件通信最佳实践</a></li>
      </ul>
    </li>
    <li><a href="#状态管理的最佳实践">状态管理的最佳实践</a>
      <ul>
        <li><a href="#本地状态管理">本地状态管理</a></li>
        <li><a href="#全局状态管理">全局状态管理</a></li>
      </ul>
    </li>
    <li><a href="#react-18-新特性应用">React 18 新特性应用</a>
      <ul>
        <li><a href="#并发渲染实践">并发渲染实践</a></li>
      </ul>
    </li>
    <li><a href="#列表渲染优化">列表渲染优化</a>
      <ul>
        <li><a href="#虚拟列表实现">虚拟列表实现</a></li>
        <li><a href="#key-的最佳实践">Key 的最佳实践</a></li>
      </ul>
    </li>
    <li><a href="#数据持久化方案">数据持久化方案</a>
      <ul>
        <li><a href="#本地存储实现">本地存储实现</a></li>
        <li><a href="#服务器存储实现">服务器存储实现</a></li>
      </ul>
    </li>
    <li><a href="#你可能不需要使用-useeffect">你可能不需要使用 useEffect</a>
      <ul>
        <li><a href="#1-事件处理中的副作用">1. 事件处理中的副作用</a></li>
        <li><a href="#2-props-改变后的计算">2. props 改变后的计算</a></li>
        <li><a href="#3-状态联动更新">3. 状态联动更新</a></li>
        <li><a href="#4-数据请求">4. 数据请求</a></li>
        <li><a href="#5-订阅与取消订阅">5. 订阅与取消订阅</a></li>
        <li><a href="#最佳实践总结">最佳实践总结</a></li>
      </ul>
    </li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


        
      </div>
    </div>

    
        <div class="tags">
            
                <a href="https://example.com/tags/react">React</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
       © Copyright 
       2025 
       <span class="split">
        <svg fill="#bbbbbb" width="15" height="15" version="1.1" id="heart-15" xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 15 15">
  <path d="M13.91,6.75c-1.17,2.25-4.3,5.31-6.07,6.94c-0.1903,0.1718-0.4797,0.1718-0.67,0C5.39,12.06,2.26,9,1.09,6.75&#xA;&#x9;C-1.48,1.8,5-1.5,7.5,3.45C10-1.5,16.48,1.8,13.91,6.75z"/>
</svg>
       </span>
       闫庆国
    
    </div>

</footer>



  </body>
</html>
